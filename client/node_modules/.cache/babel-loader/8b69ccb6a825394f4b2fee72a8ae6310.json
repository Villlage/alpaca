{"ast":null,"code":"import _objectSpread from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useLayoutEffect,useState}from'react';import'./style.scss';import PageContent from'../../../../../modules/common/PageContent';import Icon from'../../../../../components/Icon';import Button from'../../../../../components/Button';import PopUp from'../../../../../components/PopUp';import Input from'../../../../../components/Input';import Select from'../../../../../components/Select/Select';import CompanyService from'../../../../../../services/company.service';import Message from'../../../../../components/Message';import{makeName,notEmptyArray,validateEmail}from'../../../../../../helpers/base';import{emailErrorMessage}from'../../../../../../constants/auth';var companyService=new CompanyService();export default function CompanyCoaches(props){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],set_loading=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),request_error=_useState4[0],set_request_error=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),email_error=_useState6[0],set_email_error=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),coaches=_useState8[0],set_coaches=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),show_new_coach_popup=_useState10[0],set_show_new_coach_popup=_useState10[1];var _useState11=useState({first_name:'',last_name:'',email:'',user_role:'coach'}),_useState12=_slicedToArray(_useState11,2),coach=_useState12[0],set_coach=_useState12[1];var getCoaches=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return companyService.coaches(props.currentUser.company);case 3:res=_context.sent;set_loading(false);if(!(res&&res.error||res.err_msg)){_context.next=8;break;}set_request_error(res.error||res.err_msg);return _context.abrupt(\"return\",setTimeout(function(){return set_request_error('');},3000));case 8:set_coaches(res);_context.next=16;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);set_loading(false);set_request_error(_context.t0.error||_context.t0.toString());setTimeout(function(){return set_request_error('');},3000);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function getCoaches(){return _ref.apply(this,arguments);};}();var invite=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:set_loading(true);_context2.prev=1;_context2.next=4;return companyService.inviteCoach(props.currentUser.company,_objectSpread({},coach,{user_role:coach.user_role==='coach'?0:1}));case 4:res=_context2.sent;set_loading(false);if(!(res&&res.error||res.err_msg)){_context2.next=9;break;}set_request_error(res.error||res.err_msg);return _context2.abrupt(\"return\",setTimeout(function(){return set_request_error('');},3000));case 9:set_show_new_coach_popup(false);_context2.next=17;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](1);set_loading(false);set_request_error(_context2.t0.error||_context2.t0.toString());setTimeout(function(){return set_request_error('');},3000);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[1,12]]);}));return function invite(){return _ref2.apply(this,arguments);};}();useLayoutEffect(function(){getCoaches();},[]);var notValid=function notValid(){return Object.values(coach).some(function(i){return i.length<1;});};return/*#__PURE__*/React.createElement(\"article\",{className:\"CompanyCoaches-page\"},/*#__PURE__*/React.createElement(PageContent,null,/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"h2\",{className:\"page-title\"},\"Coaches\"),/*#__PURE__*/React.createElement(Button,{background:\"MainWarning\",onClick:function onClick(){return set_show_new_coach_popup(true);}},/*#__PURE__*/React.createElement(Icon,{icon:\"plus\"}),\" New Coach\")),/*#__PURE__*/React.createElement(\"section\",{className:\"coaches\"},notEmptyArray(coaches)&&coaches.map(function(coach,i){return/*#__PURE__*/React.createElement(\"div\",{className:\"coach\",key:i},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Icon,{icon:\"person\"}),/*#__PURE__*/React.createElement(\"h2\",null,coach.type,\" \",/*#__PURE__*/React.createElement(\"span\",null,makeName(coach)))),/*#__PURE__*/React.createElement(Icon,{icon:\"chevron-right\"}));})),/*#__PURE__*/React.createElement(PopUp,{isOpen:show_new_coach_popup,onClose:function onClose(){return set_show_new_coach_popup(false);}},/*#__PURE__*/React.createElement(\"section\",{className:\"new-coach\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Invite someone to join as coach\"),/*#__PURE__*/React.createElement(Input,{onChange:function onChange(e){return set_coach(_objectSpread({},coach,{first_name:e}));},value:coach.first_name,placeholder:\"First Name\"}),/*#__PURE__*/React.createElement(Input,{onChange:function onChange(e){return set_coach(_objectSpread({},coach,{last_name:e}));},value:coach.last_name,placeholder:\"Last Name\"}),/*#__PURE__*/React.createElement(Input,{value:coach.email,onChange:function onChange(e){set_email_error('');set_coach(_objectSpread({},coach,{email:e}));!validateEmail(e)&&set_email_error(emailErrorMessage);},error:email_error,placeholder:\"Email Address\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"half\"},/*#__PURE__*/React.createElement(Select,{value:coach.user_role,options:['coach','admin'],onChange:function onChange(e){return set_coach(_objectSpread({},coach,{user_role:e}));},placeholder:\"Select type\"}),/*#__PURE__*/React.createElement(Button,{onClick:invite,disabled:notValid(),loading:loading,background:\"MainWarning\"},\"SEND INVITE\")))),/*#__PURE__*/React.createElement(Message,{message:request_error}))));}","map":{"version":3,"sources":["/Users/gilad/code/commitmuse/client/src/app/pages/public/company/dashboard/coaches/index.tsx"],"names":["React","useLayoutEffect","useState","PageContent","Icon","Button","PopUp","Input","Select","CompanyService","Message","makeName","notEmptyArray","validateEmail","emailErrorMessage","companyService","CompanyCoaches","props","loading","set_loading","request_error","set_request_error","email_error","set_email_error","coaches","set_coaches","show_new_coach_popup","set_show_new_coach_popup","first_name","last_name","email","user_role","coach","set_coach","getCoaches","currentUser","company","res","error","err_msg","setTimeout","toString","invite","inviteCoach","notValid","Object","values","some","i","length","map","type","e"],"mappings":"odAAA,MAAOA,CAAAA,KAAP,EAAgBC,eAAhB,CAAiCC,QAAjC,KAAiD,OAAjD,CACA,MAAO,cAAP,CAEA,MAAOC,CAAAA,WAAP,KAAwB,2CAAxB,CAEA,MAAOC,CAAAA,IAAP,KAAiB,gCAAjB,CACA,MAAOC,CAAAA,MAAP,KAAmB,kCAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,iCAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,iCAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,yCAAnB,CACA,MAAOC,CAAAA,cAAP,KAA2B,4CAA3B,CACA,MAAOC,CAAAA,OAAP,KAAoB,mCAApB,CACA,OAASC,QAAT,CAAmBC,aAAnB,CAAkCC,aAAlC,KAAuD,gCAAvD,CACA,OAASC,iBAAT,KAAkC,kCAAlC,CAEA,GAAMC,CAAAA,cAAc,CAAG,GAAIN,CAAAA,cAAJ,EAAvB,CAIA,cAAe,SAASO,CAAAA,cAAT,CAAwBC,KAAxB,CAAoD,eAClCf,QAAQ,CAAU,IAAV,CAD0B,wCAC1DgB,OAD0D,eACjDC,WADiD,8BAEtBjB,QAAQ,CAAM,EAAN,CAFc,yCAE1DkB,aAF0D,eAE3CC,iBAF2C,8BAG1BnB,QAAQ,CAAM,EAAN,CAHkB,yCAG1DoB,WAH0D,eAG7CC,eAH6C,8BAIlCrB,QAAQ,CAAU,EAAV,CAJ0B,yCAI1DsB,OAJ0D,eAIjDC,WAJiD,8BAKRvB,QAAQ,CAAC,KAAD,CALA,0CAK1DwB,oBAL0D,gBAKpCC,wBALoC,gCAMtCzB,QAAQ,CAAC,CAClC0B,UAAU,CAAE,EADsB,CAElCC,SAAS,CAAE,EAFuB,CAGlCC,KAAK,CAAE,EAH2B,CAIlCC,SAAS,CAAE,OAJuB,CAAD,CAN8B,2CAM1DC,KAN0D,gBAMnDC,SANmD,gBAajE,GAAMC,CAAAA,UAAU,0FAAG,iLAEGnB,CAAAA,cAAc,CAACS,OAAf,CAAuBP,KAAK,CAACkB,WAAN,CAAkBC,OAAzC,CAFH,QAETC,GAFS,eAGflB,WAAW,CAAC,KAAD,CAAX,CAHe,KAKVkB,GAAG,EAAIA,GAAG,CAACC,KAAZ,EAAsBD,GAAG,CAACE,OALf,0BAMblB,iBAAiB,CAACgB,GAAG,CAACC,KAAJ,EAAaD,GAAG,CAACE,OAAlB,CAAjB,CANa,gCAONC,UAAU,CAAC,iBAAMnB,CAAAA,iBAAiB,CAAC,EAAD,CAAvB,EAAD,CAA8B,IAA9B,CAPJ,SAUfI,WAAW,CAACY,GAAD,CAAX,CAVe,iFAYflB,WAAW,CAAC,KAAD,CAAX,CACAE,iBAAiB,CAAC,YAAEiB,KAAF,EAAW,YAAEG,QAAF,EAAZ,CAAjB,CACAD,UAAU,CAAC,iBAAMnB,CAAAA,iBAAiB,CAAC,EAAD,CAAvB,EAAD,CAA8B,IAA9B,CAAV,CAde,qEAAH,kBAAVa,CAAAA,UAAU,0CAAhB,CAkBA,GAAMQ,CAAAA,MAAM,2FAAG,gJACbvB,WAAW,CAAC,IAAD,CAAX,CADa,wCAIOJ,CAAAA,cAAc,CAAC4B,WAAf,CAA2B1B,KAAK,CAACkB,WAAN,CAAkBC,OAA7C,kBACbJ,KADa,EAEhBD,SAAS,CAAEC,KAAK,CAACD,SAAN,GAAoB,OAApB,CAA8B,CAA9B,CAAkC,CAF7B,GAJP,QAILM,GAJK,gBASXlB,WAAW,CAAC,KAAD,CAAX,CATW,KAWNkB,GAAG,EAAIA,GAAG,CAACC,KAAZ,EAAsBD,GAAG,CAACE,OAXnB,2BAYTlB,iBAAiB,CAACgB,GAAG,CAACC,KAAJ,EAAaD,GAAG,CAACE,OAAlB,CAAjB,CAZS,iCAaFC,UAAU,CAAC,iBAAMnB,CAAAA,iBAAiB,CAAC,EAAD,CAAvB,EAAD,CAA8B,IAA9B,CAbR,SAgBXM,wBAAwB,CAAC,KAAD,CAAxB,CAhBW,qFAkBXR,WAAW,CAAC,KAAD,CAAX,CACAE,iBAAiB,CAAC,aAAEiB,KAAF,EAAW,aAAEG,QAAF,EAAZ,CAAjB,CACAD,UAAU,CAAC,iBAAMnB,CAAAA,iBAAiB,CAAC,EAAD,CAAvB,EAAD,CAA8B,IAA9B,CAAV,CApBW,uEAAH,kBAANqB,CAAAA,MAAM,2CAAZ,CAwBAzC,eAAe,CAAC,UAAM,CACpBiC,UAAU,GACX,CAFc,CAEZ,EAFY,CAAf,CAIA,GAAMU,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,SAAMC,CAAAA,MAAM,CAACC,MAAP,CAAcd,KAAd,EAAqBe,IAArB,CAA0B,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACC,MAAF,CAAW,CAAf,EAA3B,CAAN,EAAjB,CAEA,mBACE,+BAAS,SAAS,CAAC,qBAAnB,eACE,oBAAC,WAAD,mBACE,+CACE,0BAAI,SAAS,CAAC,YAAd,YADF,cAEE,oBAAC,MAAD,EAAQ,UAAU,CAAC,aAAnB,CAAiC,OAAO,CAAE,yBAAMtB,CAAAA,wBAAwB,CAAC,IAAD,CAA9B,EAA1C,eACE,oBAAC,IAAD,EAAM,IAAI,CAAC,MAAX,EADF,cAFF,CADF,cAOE,+BAAS,SAAS,CAAC,SAAnB,EACGf,aAAa,CAACY,OAAD,CAAb,EACCA,OAAO,CAAC0B,GAAR,CAAY,SAAClB,KAAD,CAAQgB,CAAR,qBACV,2BAAK,SAAS,CAAC,OAAf,CAAuB,GAAG,CAAEA,CAA5B,eACE,4CACE,oBAAC,IAAD,EAAM,IAAI,CAAC,QAAX,EADF,cAEE,8BACGhB,KAAK,CAACmB,IADT,kBACe,gCAAOxC,QAAQ,CAACqB,KAAD,CAAf,CADf,CAFF,CADF,cAOE,oBAAC,IAAD,EAAM,IAAI,CAAC,eAAX,EAPF,CADU,EAAZ,CAFJ,CAPF,cAqBE,oBAAC,KAAD,EAAO,MAAM,CAAEN,oBAAf,CAAqC,OAAO,CAAE,yBAAMC,CAAAA,wBAAwB,CAAC,KAAD,CAA9B,EAA9C,eACE,+BAAS,SAAS,CAAC,WAAnB,eACE,+CACE,gEADF,cAEE,oBAAC,KAAD,EACE,QAAQ,CAAE,kBAAAyB,CAAC,QAAInB,CAAAA,SAAS,kBAAMD,KAAN,EAAaJ,UAAU,CAAEwB,CAAzB,GAAb,EADb,CAEE,KAAK,CAAEpB,KAAK,CAACJ,UAFf,CAGE,WAAW,CAAC,YAHd,EAFF,cAOE,oBAAC,KAAD,EACE,QAAQ,CAAE,kBAAAwB,CAAC,QAAInB,CAAAA,SAAS,kBAAMD,KAAN,EAAaH,SAAS,CAAEuB,CAAxB,GAAb,EADb,CAEE,KAAK,CAAEpB,KAAK,CAACH,SAFf,CAGE,WAAW,CAAC,WAHd,EAPF,cAYE,oBAAC,KAAD,EACE,KAAK,CAAEG,KAAK,CAACF,KADf,CAEE,QAAQ,CAAE,kBAAAsB,CAAC,CAAI,CACb7B,eAAe,CAAC,EAAD,CAAf,CACAU,SAAS,kBAAMD,KAAN,EAAaF,KAAK,CAAEsB,CAApB,GAAT,CACA,CAACvC,aAAa,CAACuC,CAAD,CAAd,EAAqB7B,eAAe,CAACT,iBAAD,CAApC,CACD,CANH,CAOE,KAAK,CAAEQ,WAPT,CAQE,WAAW,CAAC,eARd,EAZF,cAsBE,2BAAK,SAAS,CAAC,MAAf,eACE,oBAAC,MAAD,EACE,KAAK,CAAEU,KAAK,CAACD,SADf,CAEE,OAAO,CAAE,CAAC,OAAD,CAAU,OAAV,CAFX,CAGE,QAAQ,CAAE,kBAAAqB,CAAC,QAAInB,CAAAA,SAAS,kBAAMD,KAAN,EAAaD,SAAS,CAAEqB,CAAxB,GAAb,EAHb,CAIE,WAAW,CAAC,aAJd,EADF,cAOE,oBAAC,MAAD,EAAQ,OAAO,CAAEV,MAAjB,CAAyB,QAAQ,CAAEE,QAAQ,EAA3C,CAA+C,OAAO,CAAE1B,OAAxD,CAAiE,UAAU,CAAC,aAA5E,gBAPF,CAtBF,CADF,CADF,cAqCE,oBAAC,OAAD,EAAS,OAAO,CAAEE,aAAlB,EArCF,CArBF,CADF,CADF,CAiED","sourcesContent":["import React, { useLayoutEffect, useState } from 'react'\nimport './style.scss'\nimport { Coach, ScreenProps } from '../../../../../../interfaces/baseIntefaces'\nimport PageContent from '../../../../../modules/common/PageContent'\nimport MenuSideBar from '../../../../../modules/company/MenuSideBar'\nimport Icon from '../../../../../components/Icon'\nimport Button from '../../../../../components/Button'\nimport PopUp from '../../../../../components/PopUp'\nimport Input from '../../../../../components/Input'\nimport Select from '../../../../../components/Select/Select'\nimport CompanyService from '../../../../../../services/company.service'\nimport Message from '../../../../../components/Message'\nimport { makeName, notEmptyArray, validateEmail } from '../../../../../../helpers/base'\nimport { emailErrorMessage } from '../../../../../../constants/auth'\n\nconst companyService = new CompanyService()\n\ninterface CompanyCoachesProps extends ScreenProps {}\n\nexport default function CompanyCoaches(props: CompanyCoachesProps) {\n  const [loading, set_loading] = useState<boolean>(true)\n  const [request_error, set_request_error] = useState<any>('')\n  const [email_error, set_email_error] = useState<any>('')\n  const [coaches, set_coaches] = useState<Coach[]>([])\n  const [show_new_coach_popup, set_show_new_coach_popup] = useState(false)\n  const [coach, set_coach] = useState({\n    first_name: '',\n    last_name: '',\n    email: '',\n    user_role: 'coach',\n  })\n\n  const getCoaches = async () => {\n    try {\n      const res = await companyService.coaches(props.currentUser.company)\n      set_loading(false)\n\n      if ((res && res.error) || res.err_msg) {\n        set_request_error(res.error || res.err_msg)\n        return setTimeout(() => set_request_error(''), 3000)\n      }\n\n      set_coaches(res)\n    } catch (e) {\n      set_loading(false)\n      set_request_error(e.error || e.toString())\n      setTimeout(() => set_request_error(''), 3000)\n    }\n  }\n\n  const invite = async () => {\n    set_loading(true)\n\n    try {\n      const res = await companyService.inviteCoach(props.currentUser.company, {\n        ...coach,\n        user_role: coach.user_role === 'coach' ? 0 : 1,\n      })\n\n      set_loading(false)\n\n      if ((res && res.error) || res.err_msg) {\n        set_request_error(res.error || res.err_msg)\n        return setTimeout(() => set_request_error(''), 3000)\n      }\n\n      set_show_new_coach_popup(false)\n    } catch (e) {\n      set_loading(false)\n      set_request_error(e.error || e.toString())\n      setTimeout(() => set_request_error(''), 3000)\n    }\n  }\n\n  useLayoutEffect(() => {\n    getCoaches()\n  }, [])\n\n  const notValid = () => Object.values(coach).some(i => i.length < 1)\n\n  return (\n    <article className=\"CompanyCoaches-page\">\n      <PageContent>\n        <header>\n          <h2 className=\"page-title\">Coaches</h2>\n          <Button background=\"MainWarning\" onClick={() => set_show_new_coach_popup(true)}>\n            <Icon icon=\"plus\" /> New Coach\n          </Button>\n        </header>\n        <section className=\"coaches\">\n          {notEmptyArray(coaches) &&\n            coaches.map((coach, i) => (\n              <div className=\"coach\" key={i}>\n                <div>\n                  <Icon icon=\"person\" />\n                  <h2>\n                    {coach.type} <span>{makeName(coach)}</span>\n                  </h2>\n                </div>\n                <Icon icon=\"chevron-right\" />\n              </div>\n            ))}\n        </section>\n        <PopUp isOpen={show_new_coach_popup} onClose={() => set_show_new_coach_popup(false)}>\n          <section className=\"new-coach\">\n            <header>\n              <h2>Invite someone to join as coach</h2>\n              <Input\n                onChange={e => set_coach({ ...coach, first_name: e })}\n                value={coach.first_name}\n                placeholder=\"First Name\"\n              />\n              <Input\n                onChange={e => set_coach({ ...coach, last_name: e })}\n                value={coach.last_name}\n                placeholder=\"Last Name\"\n              />\n              <Input\n                value={coach.email}\n                onChange={e => {\n                  set_email_error('')\n                  set_coach({ ...coach, email: e })\n                  !validateEmail(e) && set_email_error(emailErrorMessage)\n                }}\n                error={email_error}\n                placeholder=\"Email Address\"\n              />\n              <div className=\"half\">\n                <Select\n                  value={coach.user_role}\n                  options={['coach', 'admin']}\n                  onChange={e => set_coach({ ...coach, user_role: e })}\n                  placeholder=\"Select type\"\n                />\n                <Button onClick={invite} disabled={notValid()} loading={loading} background=\"MainWarning\">\n                  SEND INVITE\n                </Button>\n              </div>\n            </header>\n          </section>\n          <Message message={request_error} />\n        </PopUp>\n      </PageContent>\n    </article>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}