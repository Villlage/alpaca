{"ast":null,"code":"import _regeneratorRuntime from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./style.scss';import React,{useState}from'react';import PageContent from'../../../../../../modules/common/PageContent';import FAQ from'../../../../../../modules/company/CreateIsa/FAQ';import{fixClass,isNumber,validateEmail}from'../../../../../../../helpers/base';import{emailErrorMessage}from'../../../../../../../constants/auth';import Input from'../../../../../../components/Input';import TooltipBadge from'../../../../../../components/TooltipBadge';import Button from'../../../../../../components/Button';import IsaService from'../../../../../../../services/isa.service';import Message from'../../../../../../components/Message';import IsaAssessment from'../../../../../../modules/common/IsaAssessment';import ISACalculator from'../../../../../../modules/on-boarding/ISACalculator';import MenuSideBar from'../../../../../../modules/company/MenuSideBar';var isaService=new IsaService();var pricing=['From total income','From new raise','Placement'];var OFFER_STEPS=['client','program','isa offer','review','contract'];export default function CompanyCreateIsa(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],set_loading=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),request_error=_useState4[0],set_request_error=_useState4[1];var _useState5=useState(pricing[0]),_useState6=_slicedToArray(_useState5,2),selected_pricing=_useState6[0],set_selected_pricing=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),active_step=_useState8[0],set_active_step=_useState8[1];var _useState9=useState({email:'',first_name:'',last_name:''}),_useState10=_slicedToArray(_useState9,2),client=_useState10[0],set_client=_useState10[1];var _useState11=useState({email:'',first_name:'',last_name:''}),_useState12=_slicedToArray(_useState11,2),error=_useState12[0],set_error=_useState12[1];var _useState13=useState({description:'',percentage:'17',time_to_be_paid:'2',cap:'10000',cancellation_period:'2',risk:'20',current_income:'80000'}),_useState14=_slicedToArray(_useState13,2),total_income=_useState14[0],set_total_income=_useState14[1];var setIncome=function setIncome(e,key){return set_total_income(_objectSpread({},total_income,_defineProperty({},key,e)));};var notValid=function notValid(){return Object.values(client).some(function(i){return i==='';})||Object.values(total_income).some(function(i){return i==='';})||!validateEmail(client.email);};var sendOffer=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:set_loading(true);_context.prev=1;_context.next=4;return isaService.create({current_income:removeComma(total_income.current_income),percentage:Number(total_income.percentage),cap:removeComma(total_income.cap),cancellation_period_weeks:Number(total_income.cancellation_period),time_to_be_paid:Number(total_income.time_to_be_paid),status:'created',description:total_income.description,client:client,coach_id:props.currentUser.id});case 4:res=_context.sent;if(!(res&&res.error)){_context.next=9;break;}set_loading(false);set_request_error(res.error);return _context.abrupt(\"return\",setTimeout(function(){return set_request_error('');},3000));case 9:set_loading(false);return _context.abrupt(\"return\",props.history.push(\"/isa/\".concat(res.id)));case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);set_loading(false);set_request_error(_context.t0.error||_context.t0.toString());setTimeout(function(){return set_request_error('');},3000);case 18:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function sendOffer(){return _ref.apply(this,arguments);};}();var addComma=function addComma(str){return Number(str.replace(/,/g,'')).toLocaleString();};var removeComma=function removeComma(str){return Number(str.replace(/,/g,''));};var offer_step_strategy={client:'',program:'','isa offer':'',review:'',contract:''};return/*#__PURE__*/React.createElement(\"article\",{className:\"CompanyCreateIsa-page\"},/*#__PURE__*/React.createElement(MenuSideBar,null),/*#__PURE__*/React.createElement(PageContent,{title:\"New ISA Offer\"},/*#__PURE__*/React.createElement(\"section\",{className:\"container\"},/*#__PURE__*/React.createElement(\"section\",{className:\"offer-steps\"}),/*#__PURE__*/React.createElement(\"section\",{className:\"client-info\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Client Information\"),/*#__PURE__*/React.createElement(Input,{onChange:function onChange(e){return set_client(_objectSpread({},client,{first_name:e}));},value:client.first_name,placeholder:\"First Name\"}),/*#__PURE__*/React.createElement(Input,{onChange:function onChange(e){return set_client(_objectSpread({},client,{last_name:e}));},value:client.last_name,placeholder:\"Last Name\"}),/*#__PURE__*/React.createElement(Input,{className:\"email\",error:error.email,onChange:function onChange(e){set_error(_objectSpread({},error,{email:''}));set_client(_objectSpread({},client,{email:e}));!validateEmail(e)&&set_error(_objectSpread({},error,{email:emailErrorMessage}));},value:client.email,placeholder:\"Email Address\"})),/*#__PURE__*/React.createElement(\"footer\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Offer Details\"),/*#__PURE__*/React.createElement(TooltipBadge,{label:\"Pricing\",tooltip:\"help text\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"selects\"},pricing.map(function(item,i){return/*#__PURE__*/React.createElement(\"button\",{key:i,className:\"\".concat(fixClass(selected_pricing===item&&'selected')),onClick:function onClick(){return set_selected_pricing(item);}},item);})),/*#__PURE__*/React.createElement(\"div\",{className:\"form\"},/*#__PURE__*/React.createElement(Input,{onChange:function onChange(e){return setIncome(e,'description');},placeholder:\"Description\",value:total_income.description}),selected_pricing==='From total income'&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Input,{postFix:\"$\",onChange:function onChange(e){return setIncome(e,'current_income');},placeholder:\"Current income\",value:addComma(total_income.current_income)}),/*#__PURE__*/React.createElement(Input,{postFix:\"%\",onChange:function onChange(e){return isNumber(e)&&Number(e)>0&&Number(e)<100&&setIncome(e,'percentage');},placeholder:\"Percentage to be Paid\",value:total_income.percentage}),/*#__PURE__*/React.createElement(Input,{postFix:\"Months\",onChange:function onChange(e){return isNumber(e)&&setIncome(e,'time_to_be_paid');},placeholder:\"Time to be Paid\",value:total_income.time_to_be_paid}),/*#__PURE__*/React.createElement(Input,{postFix:\"USD\",onChange:function onChange(e){return setIncome(e,'cap');},placeholder:\"Maximum to be paid\",value:addComma(total_income.cap)}),/*#__PURE__*/React.createElement(Input,{postFix:\"Weeks\",onChange:function onChange(e){return isNumber(e)&&setIncome(e,'cancellation_period');},placeholder:\"Cancellation Period\",value:total_income.cancellation_period}),/*#__PURE__*/React.createElement(Input,{postFix:\"%\",onChange:function onChange(e){return isNumber(e)&&setIncome(e,'risk');},placeholder:\"Risk Assessment\",value:total_income.risk}),!notValid()&&/*#__PURE__*/React.createElement(IsaAssessment,null)))),selected_pricing.length>0&&/*#__PURE__*/React.createElement(\"div\",{className:\"actions\"},/*#__PURE__*/React.createElement(Button,{disabled:notValid(),onClick:sendOffer,loading:loading},\"REVIEW and send offer\"))),/*#__PURE__*/React.createElement(\"section\",{className:\"faq-and-calc\"},/*#__PURE__*/React.createElement(ISACalculator,{current_income:removeComma(total_income.current_income),percentage:Number(total_income.percentage),months:Number(total_income.time_to_be_paid),max:removeComma(total_income.cap)}),/*#__PURE__*/React.createElement(FAQ,null)))),/*#__PURE__*/React.createElement(Message,{message:request_error}));}","map":{"version":3,"sources":["/Users/gilad/code/commitmuse/client/src/app/pages/public/company/dashboard/my-isas/create-isa/index.tsx"],"names":["React","useState","PageContent","FAQ","fixClass","isNumber","validateEmail","emailErrorMessage","Input","TooltipBadge","Button","IsaService","Message","IsaAssessment","ISACalculator","MenuSideBar","isaService","pricing","OFFER_STEPS","CompanyCreateIsa","props","loading","set_loading","request_error","set_request_error","selected_pricing","set_selected_pricing","active_step","set_active_step","email","first_name","last_name","client","set_client","error","set_error","description","percentage","time_to_be_paid","cap","cancellation_period","risk","current_income","total_income","set_total_income","setIncome","e","key","notValid","Object","values","some","i","sendOffer","create","removeComma","Number","cancellation_period_weeks","status","coach_id","currentUser","id","res","setTimeout","history","push","toString","addComma","str","replace","toLocaleString","offer_step_strategy","program","review","contract","map","item","length"],"mappings":"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","sourcesContent":["import './style.scss'\nimport React, { useState } from 'react'\nimport { ScreenProps } from '../../../../../../../interfaces/baseIntefaces'\nimport PageContent from '../../../../../../modules/common/PageContent'\nimport FAQ from '../../../../../../modules/company/CreateIsa/FAQ'\nimport { fixClass, isNumber, validateEmail } from '../../../../../../../helpers/base'\nimport { emailErrorMessage } from '../../../../../../../constants/auth'\nimport Input from '../../../../../../components/Input'\nimport TooltipBadge from '../../../../../../components/TooltipBadge'\nimport Button from '../../../../../../components/Button'\nimport IsaService from '../../../../../../../services/isa.service'\nimport Message from '../../../../../../components/Message'\nimport IsaAssessment from '../../../../../../modules/common/IsaAssessment'\nimport ISACalculator from '../../../../../../modules/on-boarding/ISACalculator'\nimport MenuSideBar from '../../../../../../modules/company/MenuSideBar'\n\nconst isaService = new IsaService()\n\nconst pricing = ['From total income', 'From new raise', 'Placement']\nconst OFFER_STEPS = ['client', 'program', 'isa offer', 'review', 'contract']\n\ntype IncomeKeys =\n  | 'description'\n  | 'percentage'\n  | 'time_to_be_paid'\n  | 'cap'\n  | 'cancellation_period'\n  | 'risk'\n  | 'current_income'\n\ninterface CreateIsaProps extends ScreenProps {}\n\nexport default function CompanyCreateIsa(props: CreateIsaProps) {\n  const [loading, set_loading] = useState(false)\n  const [request_error, set_request_error] = useState('')\n  const [selected_pricing, set_selected_pricing] = useState(pricing[0])\n  const [active_step, set_active_step] = useState(0)\n\n  const [client, set_client] = useState({\n    email: '',\n    first_name: '',\n    last_name: '',\n  })\n\n  const [error, set_error] = useState({\n    email: '',\n    first_name: '',\n    last_name: '',\n  })\n\n  const [total_income, set_total_income] = useState({\n    description: '',\n    percentage: '17',\n    time_to_be_paid: '2',\n    cap: '10000',\n    cancellation_period: '2',\n    risk: '20',\n    current_income: '80000',\n  })\n\n  const setIncome = (e: string, key: IncomeKeys) => set_total_income({ ...total_income, [key]: e })\n\n  const notValid = () =>\n    Object.values(client).some(i => i === '') ||\n    Object.values(total_income).some(i => i === '') ||\n    !validateEmail(client.email)\n\n  const sendOffer = async () => {\n    set_loading(true)\n    try {\n      const res = await isaService.create({\n        current_income: removeComma(total_income.current_income),\n        percentage: Number(total_income.percentage),\n        cap: removeComma(total_income.cap),\n        cancellation_period_weeks: Number(total_income.cancellation_period),\n        time_to_be_paid: Number(total_income.time_to_be_paid),\n        status: 'created',\n        description: total_income.description,\n        client,\n        coach_id: props.currentUser.id,\n      })\n\n      if (res && res.error) {\n        set_loading(false)\n        set_request_error(res.error)\n        return setTimeout(() => set_request_error(''), 3000)\n      }\n      set_loading(false)\n\n      return props.history.push(`/isa/${res.id}`)\n    } catch (e) {\n      set_loading(false)\n      set_request_error(e.error || e.toString())\n      setTimeout(() => set_request_error(''), 3000)\n    }\n  }\n\n  const addComma = (str: string) => {\n    return Number(str.replace(/,/g, '')).toLocaleString()\n  }\n\n  const removeComma = (str: string) => {\n    return Number(str.replace(/,/g, ''))\n  }\n\n  const offer_step_strategy: any = {\n    client: '',\n    program: '',\n    'isa offer': '',\n    review: '',\n    contract: '',\n  }\n\n  return (\n    <article className=\"CompanyCreateIsa-page\">\n      <MenuSideBar />\n      <PageContent title=\"New ISA Offer\">\n        <section className=\"container\">\n          <section className=\"offer-steps\">\n            {/*<Stepper steps={OFFER_STEPS} activeIndex={active_step}/>*/}\n            {/*{offer_step_strategy[OFFER_STEPS[active_step]]}*/}\n          </section>\n          <section className=\"client-info\">\n            <header>\n              <h2>Client Information</h2>\n              <Input\n                onChange={e => set_client({ ...client, first_name: e })}\n                value={client.first_name}\n                placeholder=\"First Name\"\n              />\n              <Input\n                onChange={e => set_client({ ...client, last_name: e })}\n                value={client.last_name}\n                placeholder=\"Last Name\"\n              />\n              <Input\n                className=\"email\"\n                error={error.email}\n                onChange={e => {\n                  set_error({ ...error, email: '' })\n                  set_client({ ...client, email: e })\n                  !validateEmail(e) && set_error({ ...error, email: emailErrorMessage })\n                }}\n                value={client.email}\n                placeholder=\"Email Address\"\n              />\n            </header>\n            <footer>\n              <h2>Offer Details</h2>\n              <TooltipBadge label=\"Pricing\" tooltip=\"help text\" />\n              <div className=\"selects\">\n                {pricing.map((item, i) => (\n                  <button\n                    key={i}\n                    className={`${fixClass(selected_pricing === item && 'selected')}`}\n                    onClick={() => set_selected_pricing(item)}\n                  >\n                    {item}\n                  </button>\n                ))}\n              </div>\n              <div className=\"form\">\n                <Input\n                  onChange={e => setIncome(e, 'description')}\n                  placeholder=\"Description\"\n                  value={total_income.description}\n                />\n                {selected_pricing === 'From total income' && (\n                  <>\n                    <Input\n                      postFix=\"$\"\n                      onChange={e => setIncome(e, 'current_income')}\n                      placeholder=\"Current income\"\n                      value={addComma(total_income.current_income)}\n                    />\n                    <Input\n                      postFix=\"%\"\n                      onChange={e => isNumber(e) && Number(e) > 0 && Number(e) < 100 && setIncome(e, 'percentage')}\n                      placeholder=\"Percentage to be Paid\"\n                      value={total_income.percentage}\n                    />\n                    <Input\n                      postFix=\"Months\"\n                      onChange={e => isNumber(e) && setIncome(e, 'time_to_be_paid')}\n                      placeholder=\"Time to be Paid\"\n                      value={total_income.time_to_be_paid}\n                    />\n                    <Input\n                      postFix=\"USD\"\n                      onChange={e => setIncome(e, 'cap')}\n                      placeholder=\"Maximum to be paid\"\n                      value={addComma(total_income.cap)}\n                    />\n                    <Input\n                      postFix=\"Weeks\"\n                      onChange={e => isNumber(e) && setIncome(e, 'cancellation_period')}\n                      placeholder=\"Cancellation Period\"\n                      value={total_income.cancellation_period}\n                    />\n                    <Input\n                      postFix=\"%\"\n                      onChange={e => isNumber(e) && setIncome(e, 'risk')}\n                      placeholder=\"Risk Assessment\"\n                      value={total_income.risk}\n                    />\n                    {!notValid() && <IsaAssessment />}\n                  </>\n                )}\n              </div>\n            </footer>\n            {selected_pricing.length > 0 && (\n              <div className=\"actions\">\n                <Button disabled={notValid()} onClick={sendOffer} loading={loading}>\n                  REVIEW and send offer\n                </Button>\n              </div>\n            )}\n          </section>\n\n          <section className=\"faq-and-calc\">\n            <ISACalculator\n              current_income={removeComma(total_income.current_income)}\n              percentage={Number(total_income.percentage)}\n              months={Number(total_income.time_to_be_paid)}\n              max={removeComma(total_income.cap)}\n            />\n            <FAQ />\n          </section>\n        </section>\n      </PageContent>\n      <Message message={request_error} />\n    </article>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}