{"ast":null,"code":"import _objectSpread from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import'./style.scss';import Input from'../../../../../components/Input';import Button from'../../../../../components/Button';import{validateEmail}from'../../../../../../helpers/base';import AuthService from'../../../../../../services/auth.service';import{log}from'../../../../../../services/logging.service';import{emailErrorMessage,passwordLength,passwordMustMatch}from'../../../../../../constants/auth';import Message from'../../../../../components/Message';var authService=new AuthService();export default function ClientIsaSignUp(props){var _useState=useState({email:'',password:''}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],set_user=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password_confirm=_useState4[0],set_password_confirm=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],set_loading=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),request_error=_useState8[0],set_request_error=_useState8[1];var _useState9=useState({email:'',password:'',password_confirm:''}),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],set_error=_useState10[1];var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:set_loading(true);_context.prev=1;_context.next=4;return authService.register(user);case 4:res=_context.sent;if(!res){_context.next=13;break;}if(!res.error){_context.next=10;break;}set_loading(false);set_request_error(res.error);return _context.abrupt(\"return\",setTimeout(function(){return set_request_error('');},3000));case 10:set_loading(false);_context.next=13;return props.onNext();case 13:_context.next=21;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](1);set_loading(false);log('Error on sign in: ',_context.t0);set_request_error(_context.t0.error||_context.t0.toString);return _context.abrupt(\"return\",setTimeout(function(){return set_request_error('');},3000));case 21:case\"end\":return _context.stop();}}},_callee,null,[[1,15]]);}));return function onSubmit(){return _ref.apply(this,arguments);};}();var notValid=function notValid(){return Object.values(user).some(function(i){return i==='';})||!validateEmail(user.email)||user.password.length<6||password_confirm!==user.password;};return/*#__PURE__*/React.createElement(\"section\",{className:\"ClientIsaSignUp-module\"},/*#__PURE__*/React.createElement(\"div\",{className:\"fields\"},/*#__PURE__*/React.createElement(Input,{className:\"full\",icon:\"mail\",placeholder:\"Email Address *\",error:error.email,value:user.email,onChange:function onChange(e){set_error(_objectSpread({},error,{email:''}));set_user(_objectSpread({},user,{email:e}));!validateEmail(e)&&set_error(_objectSpread({},error,{email:emailErrorMessage}));}}),/*#__PURE__*/React.createElement(Input,{className:\"full\",icon:\"key\",placeholder:\"Password *\",type:\"password\",error:error.password,value:user.password,onChange:function onChange(e){set_error(_objectSpread({},error,{password:''}));set_user(_objectSpread({},user,{password:e}));e.length<6&&set_error(_objectSpread({},error,{password:passwordLength}));}}),/*#__PURE__*/React.createElement(Input,{className:\"full\",icon:\"key\",placeholder:\"Confirm your password *\",type:\"password\",error:error.password_confirm,value:password_confirm,onChange:function onChange(e){set_error(_objectSpread({},error,{password_confirm:''}));set_password_confirm(e);e!==user.password&&set_error(_objectSpread({},error,{password_confirm:passwordMustMatch}));}})),/*#__PURE__*/React.createElement(\"footer\",null,/*#__PURE__*/React.createElement(Button,{background:\"MainWarning\",disabled:notValid(),onClick:onSubmit,icon:\"arrow-right\",loading:loading},\"NEXT\")),request_error.length>0&&/*#__PURE__*/React.createElement(Message,{message:request_error}));}","map":{"version":3,"sources":["/Users/gilad/code/commitmuse/client/src/app/pages/public/client/isa-offer-steps/sign-up/index.tsx"],"names":["React","useState","Input","Button","validateEmail","AuthService","log","emailErrorMessage","passwordLength","passwordMustMatch","Message","authService","ClientIsaSignUp","props","email","password","user","set_user","password_confirm","set_password_confirm","loading","set_loading","request_error","set_request_error","error","set_error","onSubmit","register","res","setTimeout","onNext","toString","notValid","Object","values","some","i","length","e"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport './style.scss'\nimport Input from '../../../../../components/Input'\nimport Button from '../../../../../components/Button'\nimport { validateEmail } from '../../../../../../helpers/base'\nimport AuthService from '../../../../../../services/auth.service'\nimport { log } from '../../../../../../services/logging.service'\nimport { emailErrorMessage, passwordLength, passwordMustMatch } from '../../../../../../constants/auth'\nimport Message from '../../../../../components/Message'\n\nconst authService = new AuthService()\n\ninterface ClientIsaSignUpProps {\n  onNext(): void\n}\n\nexport default function ClientIsaSignUp(props: ClientIsaSignUpProps) {\n  const [user, set_user] = useState({\n    email: '',\n    password: '',\n  })\n\n  const [password_confirm, set_password_confirm] = useState('')\n  const [loading, set_loading] = useState(false)\n  const [request_error, set_request_error] = useState('')\n\n  const [error, set_error] = useState({\n    email: '',\n    password: '',\n    password_confirm: '',\n  })\n\n  const onSubmit = async () => {\n    set_loading(true)\n    try {\n      const res = await authService.register(user)\n\n      if (res) {\n        if (res.error) {\n          set_loading(false)\n          set_request_error(res.error)\n          return setTimeout(() => set_request_error(''), 3000)\n        }\n\n        set_loading(false)\n        await props.onNext()\n      }\n    } catch (e) {\n      set_loading(false)\n      log('Error on sign in: ', e)\n      set_request_error(e.error || e.toString)\n      return setTimeout(() => set_request_error(''), 3000)\n    }\n  }\n\n  const notValid = () =>\n    Object.values(user).some(i => i === '') || !validateEmail(user.email) || user.password.length < 6 || password_confirm !== user.password\n\n  return (\n    <section className=\"ClientIsaSignUp-module\">\n      <div className=\"fields\">\n        <Input\n          className=\"full\"\n          icon=\"mail\"\n          placeholder=\"Email Address *\"\n          error={error.email}\n          value={user.email}\n          onChange={e => {\n            set_error({ ...error, email: '' })\n            set_user({ ...user, email: e })\n            !validateEmail(e) && set_error({ ...error, email: emailErrorMessage })\n          }}\n        />\n        <Input\n          className=\"full\"\n          icon=\"key\"\n          placeholder=\"Password *\"\n          type=\"password\"\n          error={error.password}\n          value={user.password}\n          onChange={e => {\n            set_error({ ...error, password: '' })\n            set_user({ ...user, password: e })\n            e.length < 6 && set_error({ ...error, password: passwordLength })\n          }}\n        />\n        <Input\n          className=\"full\"\n          icon=\"key\"\n          placeholder=\"Confirm your password *\"\n          type=\"password\"\n          error={error.password_confirm}\n          value={password_confirm}\n          onChange={e => {\n            set_error({ ...error, password_confirm: '' })\n            set_password_confirm(e)\n            e !== user.password && set_error({ ...error, password_confirm: passwordMustMatch })\n          }}\n        />\n      </div>\n      <footer>\n        <Button background=\"MainWarning\" disabled={notValid()} onClick={onSubmit} icon=\"arrow-right\" loading={loading}>\n          NEXT\n        </Button>\n      </footer>\n      {request_error.length > 0 && <Message message={request_error} />}\n    </section>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}