{"ast":null,"code":"import _defineProperty from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./style.scss';import React,{useState}from'react';import PageContent from'../../../../../../modules/common/PageContent';import IsaService from'../../../../../../../services/isa.service';import Message from'../../../../../../components/Message';import Stepper from'../../../../../../modules/common/Stepper';import ClientStep from'../../../../../../modules/company/CreateIsa/ClientStep';import ProgramStep from'../../../../../../modules/company/CreateIsa/ProgramStep';import IsaOfferStep from'../../../../../../modules/company/CreateIsa/IsaOfferStep';import ReviewStep from'../../../../../../modules/company/CreateIsa/ReviewStep';import ContractStep from'../../../../../../modules/company/CreateIsa/ContractStep/ContractStep';import ISACalculator from'../../../../../../modules/on-boarding/ISACalculator';import FAQ from'../../../../../../modules/company/CreateIsa/FAQ';import Icon from'../../../../../../components/Icon';var isaService=new IsaService();var OFFER_STEPS=['client','program','isa offer','review','contract'];export default function CompanyCreateIsa(props){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),request_error=_useState2[0],set_request_error=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),active_step=_useState4[0],set_active_step=_useState4[1];var _useState5=useState({email:'',first_name:'',last_name:''}),_useState6=_slicedToArray(_useState5,2),client=_useState6[0],set_client=_useState6[1];var _useState7=useState({field:'',duration:'',description:''}),_useState8=_slicedToArray(_useState7,2),program=_useState8[0],set_program=_useState8[1];var _useState9=useState({type:'From total income'}),_useState10=_slicedToArray(_useState9,2),offer=_useState10[0],set_offer=_useState10[1];var _useState11=useState({percentage:'17',time_to_be_paid:'2',cap:'10000',cancellation_period:'2',expiration_period_months:'2',risk:'20',current_income:'80000'}),_useState12=_slicedToArray(_useState11,2),total_income=_useState12[0],set_total_income=_useState12[1];var sendOffer=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return isaService.create({current_income:removeComma(total_income.current_income),percentage:Number(total_income.percentage),cap:removeComma(total_income.cap),cancellation_period_weeks:Number(total_income.cancellation_period),time_to_be_paid:Number(total_income.time_to_be_paid),description:program.description,client:client,coach_id:props.currentUser.id,industry_field:program.field,program_duration_weeks:program.duration,status:'created',expiration_period_months:total_income.expiration_period_months});case 3:res=_context.sent;if(!(res&&res.error)){_context.next=7;break;}set_request_error(res.error);return _context.abrupt(\"return\",setTimeout(function(){return set_request_error('');},3000));case 7:set_active_step(active_step+1);return _context.abrupt(\"return\",props.history.push(\"/company/isas/contract/\".concat(res.id)));case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);set_request_error(_context.t0.error||_context.t0.toString());setTimeout(function(){return set_request_error('');},3000);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function sendOffer(){return _ref.apply(this,arguments);};}();var removeComma=function removeComma(str){return Number(str.replace(/,/g,''));};var offer_step_strategy={client:/*#__PURE__*/React.createElement(ClientStep,{client:client,onChange:function onChange(e,key){return set_client(_objectSpread({},client,_defineProperty({},key,e)));},onNext:function onNext(){return set_active_step(active_step+1);}}),program:/*#__PURE__*/React.createElement(ProgramStep,{onChange:function onChange(e,key){return set_program(_objectSpread({},program,_defineProperty({},key,e)));},onNext:function onNext(){return set_active_step(active_step+1);},program:program}),'isa offer':/*#__PURE__*/React.createElement(IsaOfferStep,{offer:offer,onChange:function onChange(e,key){return set_offer(_objectSpread({},offer,_defineProperty({},key,e)));},onNext:function onNext(){return set_active_step(active_step+1);}}),review:/*#__PURE__*/React.createElement(ReviewStep,{client:client,program:program,offer:offer,total_income:total_income,onChange:function onChange(e,key){return set_total_income(_objectSpread({},total_income,_defineProperty({},key,e)));},onNext:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return sendOffer();case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}}},_callee2);}))}),contract:/*#__PURE__*/React.createElement(ContractStep,{onNext:function onNext(){return null;}})};return/*#__PURE__*/React.createElement(\"article\",{className:\"CompanyCreateIsa-page\"},/*#__PURE__*/React.createElement(PageContent,null,/*#__PURE__*/React.createElement(\"h1\",{className:\"page-title\"},active_step!==0&&/*#__PURE__*/React.createElement(Icon,{onClick:function onClick(){return set_active_step(active_step-1);},icon:\"arrow-left\"}),\" New ISA Offer\"),/*#__PURE__*/React.createElement(\"section\",{className:\"container\"},/*#__PURE__*/React.createElement(\"section\",{className:\"offer-steps\"},/*#__PURE__*/React.createElement(Stepper,{steps:OFFER_STEPS,activeIndex:active_step}),offer_step_strategy[OFFER_STEPS[active_step]]),/*#__PURE__*/React.createElement(\"section\",{className:\"faq-and-calc\"},/*#__PURE__*/React.createElement(ISACalculator,{current_income:removeComma(total_income.current_income),percentage:Number(total_income.percentage),months:Number(total_income.time_to_be_paid),max:removeComma(total_income.cap)}),/*#__PURE__*/React.createElement(FAQ,null)))),/*#__PURE__*/React.createElement(Message,{message:request_error}));}","map":{"version":3,"sources":["/Users/gilad/code/commitmuse/client/src/app/pages/public/company/dashboard/my-isas/create-isa/index.tsx"],"names":["React","useState","PageContent","IsaService","Message","Stepper","ClientStep","ProgramStep","IsaOfferStep","ReviewStep","ContractStep","ISACalculator","FAQ","Icon","isaService","OFFER_STEPS","CompanyCreateIsa","props","request_error","set_request_error","active_step","set_active_step","email","first_name","last_name","client","set_client","field","duration","description","program","set_program","type","offer","set_offer","percentage","time_to_be_paid","cap","cancellation_period","expiration_period_months","risk","current_income","total_income","set_total_income","sendOffer","create","removeComma","Number","cancellation_period_weeks","coach_id","currentUser","id","industry_field","program_duration_weeks","status","res","error","setTimeout","history","push","toString","str","replace","offer_step_strategy","e","key","review","contract"],"mappings":"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","sourcesContent":["import './style.scss'\nimport React, { useState } from 'react'\nimport { IsaClient, IsaProgram, ScreenProps } from '../../../../../../../interfaces/baseIntefaces'\nimport PageContent from '../../../../../../modules/common/PageContent'\nimport IsaService from '../../../../../../../services/isa.service'\nimport Message from '../../../../../../components/Message'\nimport Stepper from '../../../../../../modules/common/Stepper'\nimport ClientStep from '../../../../../../modules/company/CreateIsa/ClientStep'\nimport ProgramStep from '../../../../../../modules/company/CreateIsa/ProgramStep'\nimport IsaOfferStep from '../../../../../../modules/company/CreateIsa/IsaOfferStep'\nimport ReviewStep from '../../../../../../modules/company/CreateIsa/ReviewStep'\nimport ContractStep from '../../../../../../modules/company/CreateIsa/ContractStep/ContractStep'\nimport ISACalculator from '../../../../../../modules/on-boarding/ISACalculator'\nimport FAQ from '../../../../../../modules/company/CreateIsa/FAQ'\nimport Icon from '../../../../../../components/Icon'\n\nconst isaService = new IsaService()\n\nconst OFFER_STEPS = ['client', 'program', 'isa offer', 'review', 'contract']\n\ninterface CreateIsaProps extends ScreenProps {}\n\nexport default function CompanyCreateIsa(props: CreateIsaProps) {\n  const [request_error, set_request_error] = useState('')\n  const [active_step, set_active_step] = useState(0)\n\n  const [client, set_client] = useState<IsaClient>({\n    email: '',\n    first_name: '',\n    last_name: '',\n  })\n\n  const [program, set_program] = useState<IsaProgram>({\n    field: '',\n    duration: '',\n    description: '',\n  })\n\n  const [offer, set_offer] = useState({\n    type: 'From total income',\n  })\n\n  const [total_income, set_total_income] = useState({\n    percentage: '17',\n    time_to_be_paid: '2',\n    cap: '10000',\n    cancellation_period: '2',\n    expiration_period_months: '2',\n    risk: '20',\n    current_income: '80000',\n  })\n\n  const sendOffer = async () => {\n    try {\n      const res = await isaService.create({\n        current_income: removeComma(total_income.current_income),\n        percentage: Number(total_income.percentage),\n        cap: removeComma(total_income.cap),\n        cancellation_period_weeks: Number(total_income.cancellation_period),\n        time_to_be_paid: Number(total_income.time_to_be_paid),\n        description: program.description,\n        client,\n        coach_id: props.currentUser.id,\n        industry_field: program.field,\n        program_duration_weeks: program.duration,\n        status: 'created',\n        expiration_period_months: total_income.expiration_period_months,\n      })\n\n      if (res && res.error) {\n        set_request_error(res.error)\n        return setTimeout(() => set_request_error(''), 3000)\n      }\n\n      set_active_step(active_step + 1)\n      return props.history.push(`/company/isas/contract/${res.id}`)\n    } catch (e) {\n      set_request_error(e.error || e.toString())\n      setTimeout(() => set_request_error(''), 3000)\n    }\n  }\n\n  const removeComma = (str: string) => {\n    return Number(str.replace(/,/g, ''))\n  }\n\n  const offer_step_strategy: any = {\n    client: (\n      <ClientStep\n        client={client}\n        onChange={(e, key) => set_client({ ...client, [key]: e })}\n        onNext={() => set_active_step(active_step + 1)}\n      />\n    ),\n    program: (\n      <ProgramStep\n        onChange={(e, key) => set_program({ ...program, [key]: e })}\n        onNext={() => set_active_step(active_step + 1)}\n        program={program}\n      />\n    ),\n    'isa offer': (\n      <IsaOfferStep\n        offer={offer}\n        onChange={(e, key) => set_offer({ ...offer, [key]: e })}\n        onNext={() => set_active_step(active_step + 1)}\n      />\n    ),\n    review: (\n      <ReviewStep\n        client={client}\n        program={program}\n        offer={offer}\n        total_income={total_income}\n        onChange={(e, key) => set_total_income({ ...total_income, [key]: e })}\n        onNext={async () => await sendOffer()}\n      />\n    ),\n    contract: <ContractStep onNext={() => null} />,\n  }\n\n  return (\n    <article className=\"CompanyCreateIsa-page\">\n      <PageContent>\n        <h1 className=\"page-title\">\n          {active_step !== 0 && <Icon onClick={() => set_active_step(active_step - 1)} icon=\"arrow-left\" />} New ISA\n          Offer\n        </h1>\n        <section className=\"container\">\n          <section className=\"offer-steps\">\n            <Stepper steps={OFFER_STEPS} activeIndex={active_step} />\n            {offer_step_strategy[OFFER_STEPS[active_step]]}\n          </section>\n          <section className=\"faq-and-calc\">\n            <ISACalculator\n              current_income={removeComma(total_income.current_income)}\n              percentage={Number(total_income.percentage)}\n              months={Number(total_income.time_to_be_paid)}\n              max={removeComma(total_income.cap)}\n            />\n            <FAQ />\n          </section>\n        </section>\n      </PageContent>\n      <Message message={request_error} />\n    </article>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}