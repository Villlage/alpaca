{"ast":null,"code":"import _regeneratorRuntime from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useLayoutEffect,useState}from'react';import'./syle.scss';import PageContent from'../../../../modules/common/PageContent';import Icon from'../../../../components/Icon';import Button from'../../../../components/Button';import PlaidService from'../../../../../services/plaid.service';import Message from'../../../../components/Message';import Loader from'../../../../components/Loader';import CompanyService from'../../../../../services/company.service';import SubscriptionOffer from'../../../../modules/company/SubscriptionOffer';import{OFFERS}from'../../../../../constants/mockData';var plaidService=new PlaidService();var companyService=new CompanyService();export default function Subscription(props){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),request_error=_useState2[0],set_request_error=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),mask=_useState4[0],set_mask=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],set_loading=_useState6[1];var companyId=props.match.params.id;var getMask=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return plaidService.getMask(companyId);case 3:res=_context.sent;set_loading(false);if(res&&res.error||res.err_msg){set_request_error(res.error||res.err_msg);set_mask(null);}_context.next=14;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);set_mask(null);set_request_error(_context.t0.error||_context.t0.toString());setTimeout(function(){return set_request_error('');},3000);return _context.abrupt(\"return\",set_loading(false));case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function getMask(){return _ref.apply(this,arguments);};}();var subscribe=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return companyService.createSubscription(companyId);case 3:res=_context2.sent;set_loading(false);if(res&&res.error||res.err_msg){set_request_error(res.error||res.err_msg);set_mask(null);}if(!(res&&res.is_active)){_context2.next=9;break;}set_request_error({text:'Subscription created',type:'info'});return _context2.abrupt(\"return\",setTimeout(function(){return props.history.push('/company/dashboard');},2000));case 9:_context2.next=17;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);set_mask(null);set_request_error(_context2.t0.error||_context2.t0.toString());setTimeout(function(){return set_request_error('');},3000);return _context2.abrupt(\"return\",set_loading(false));case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));return function subscribe(){return _ref2.apply(this,arguments);};}();useLayoutEffect(function(){companyId&&getMask();},[]);return loading?/*#__PURE__*/React.createElement(Loader,null):/*#__PURE__*/React.createElement(\"article\",{className:\"Subscription-page\"},/*#__PURE__*/React.createElement(PageContent,{title:\"Subscription\"},mask!==null?/*#__PURE__*/React.createElement(\"section\",{className:\"subscription-offer\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Early adopter Discount offer:\"),/*#__PURE__*/React.createElement(\"div\",{className:\"offer-list\"},OFFERS.map(function(offer,i){return/*#__PURE__*/React.createElement(SubscriptionOffer,{offer:offer,key:i});})),/*#__PURE__*/React.createElement(\"div\",{className:\"payment-method\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Payment method\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,mask?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Icon,{icon:\"check-circle\"}),\"Account ending in \",mask):''))),/*#__PURE__*/React.createElement(\"footer\",null,/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return props.history.push('/company/dashboard');},className:\"skip\"},\"Skip for now\"),/*#__PURE__*/React.createElement(Button,{disabled:!companyId,onClick:subscribe,className:\"start\",background:\"MainWarning\"},\"START MY Subscription\"))):'',/*#__PURE__*/React.createElement(Message,{message:request_error})));}","map":{"version":3,"sources":["/Users/gilad/code/commitmuse/client/src/app/pages/public/company/subscription/index.tsx"],"names":["React","useLayoutEffect","useState","PageContent","Icon","Button","PlaidService","Message","Loader","CompanyService","SubscriptionOffer","OFFERS","plaidService","companyService","Subscription","props","request_error","set_request_error","mask","set_mask","loading","set_loading","companyId","match","params","id","getMask","res","error","err_msg","toString","setTimeout","subscribe","createSubscription","is_active","text","type","history","push","map","offer","i"],"mappings":"+VAAA,MAAOA,CAAAA,KAAP,EAAgBC,eAAhB,CAAiCC,QAAjC,KAAiD,OAAjD,CACA,MAAO,aAAP,CAEA,MAAOC,CAAAA,WAAP,KAAwB,wCAAxB,CACA,MAAOC,CAAAA,IAAP,KAAiB,6BAAjB,CACA,MAAOC,CAAAA,MAAP,KAAmB,+BAAnB,CACA,MAAOC,CAAAA,YAAP,KAAyB,uCAAzB,CACA,MAAOC,CAAAA,OAAP,KAAoB,gCAApB,CACA,MAAOC,CAAAA,MAAP,KAAmB,+BAAnB,CACA,MAAOC,CAAAA,cAAP,KAA2B,yCAA3B,CACA,MAAOC,CAAAA,iBAAP,KAA8B,+CAA9B,CACA,OAASC,MAAT,KAAuB,mCAAvB,CAEA,GAAMC,CAAAA,YAAY,CAAG,GAAIN,CAAAA,YAAJ,EAArB,CACA,GAAMO,CAAAA,cAAc,CAAG,GAAIJ,CAAAA,cAAJ,EAAvB,CAUA,cAAe,SAASK,CAAAA,YAAT,CAAsBC,KAAtB,CAAgD,eAClBb,QAAQ,CAAM,EAAN,CADU,wCACtDc,aADsD,eACvCC,iBADuC,8BAEpCf,QAAQ,CAAgB,EAAhB,CAF4B,yCAEtDgB,IAFsD,eAEhDC,QAFgD,8BAG9BjB,QAAQ,CAAU,IAAV,CAHsB,yCAGtDkB,OAHsD,eAG7CC,WAH6C,eAI7D,GAAMC,CAAAA,SAAS,CAAGP,KAAK,CAACQ,KAAN,CAAYC,MAAZ,CAAmBC,EAArC,CAEA,GAAMC,CAAAA,OAAO,0FAAG,iLAEMd,CAAAA,YAAY,CAACc,OAAb,CAAqBJ,SAArB,CAFN,QAENK,GAFM,eAIZN,WAAW,CAAC,KAAD,CAAX,CAEA,GAAKM,GAAG,EAAIA,GAAG,CAACC,KAAZ,EAAsBD,GAAG,CAACE,OAA9B,CAAuC,CACrCZ,iBAAiB,CAACU,GAAG,CAACC,KAAJ,EAAaD,GAAG,CAACE,OAAlB,CAAjB,CACAV,QAAQ,CAAC,IAAD,CAAR,CACD,CATW,+EAWZA,QAAQ,CAAC,IAAD,CAAR,CACAF,iBAAiB,CAAC,YAAEW,KAAF,EAAW,YAAEE,QAAF,EAAZ,CAAjB,CACAC,UAAU,CAAC,iBAAMd,CAAAA,iBAAiB,CAAC,EAAD,CAAvB,EAAD,CAA8B,IAA9B,CAAV,CAbY,gCAcLI,WAAW,CAAC,KAAD,CAdN,sEAAH,kBAAPK,CAAAA,OAAO,0CAAb,CAkBA,GAAMM,CAAAA,SAAS,2FAAG,wLAEInB,CAAAA,cAAc,CAACoB,kBAAf,CAAkCX,SAAlC,CAFJ,QAERK,GAFQ,gBAIdN,WAAW,CAAC,KAAD,CAAX,CAEA,GAAKM,GAAG,EAAIA,GAAG,CAACC,KAAZ,EAAsBD,GAAG,CAACE,OAA9B,CAAuC,CACrCZ,iBAAiB,CAACU,GAAG,CAACC,KAAJ,EAAaD,GAAG,CAACE,OAAlB,CAAjB,CACAV,QAAQ,CAAC,IAAD,CAAR,CACD,CATa,KAWVQ,GAAG,EAAIA,GAAG,CAACO,SAXD,2BAYZjB,iBAAiB,CAAC,CAAEkB,IAAI,CAAE,sBAAR,CAAgCC,IAAI,CAAE,MAAtC,CAAD,CAAjB,CAZY,iCAaLL,UAAU,CAAC,iBAAMhB,CAAAA,KAAK,CAACsB,OAAN,CAAcC,IAAd,CAAmB,oBAAnB,CAAN,EAAD,CAAiD,IAAjD,CAbL,8FAgBdnB,QAAQ,CAAC,IAAD,CAAR,CACAF,iBAAiB,CAAC,aAAEW,KAAF,EAAW,aAAEE,QAAF,EAAZ,CAAjB,CACAC,UAAU,CAAC,iBAAMd,CAAAA,iBAAiB,CAAC,EAAD,CAAvB,EAAD,CAA8B,IAA9B,CAAV,CAlBc,iCAmBPI,WAAW,CAAC,KAAD,CAnBJ,yEAAH,kBAATW,CAAAA,SAAS,2CAAf,CAuBA/B,eAAe,CAAC,UAAM,CACpBqB,SAAS,EAAII,OAAO,EAApB,CACD,CAFc,CAEZ,EAFY,CAAf,CAIA,MAAON,CAAAA,OAAO,cACZ,oBAAC,MAAD,MADY,cAGZ,+BAAS,SAAS,CAAC,mBAAnB,eACE,oBAAC,WAAD,EAAa,KAAK,CAAC,cAAnB,EACGF,IAAI,GAAK,IAAT,cACC,+BAAS,SAAS,CAAC,oBAAnB,eACE,8DADF,cAEE,2BAAK,SAAS,CAAC,YAAf,EACGP,MAAM,CAAC4B,GAAP,CAAW,SAACC,KAAD,CAAQC,CAAR,qBACV,oBAAC,iBAAD,EAAmB,KAAK,CAAED,KAA1B,CAAiC,GAAG,CAAEC,CAAtC,EADU,EAAX,CADH,CAFF,cAOE,2BAAK,SAAS,CAAC,gBAAf,eACE,+CADF,cAEE,4CACE,6BACGvB,IAAI,cACH,qDACE,oBAAC,IAAD,EAAM,IAAI,CAAC,cAAX,EADF,sBAEqBA,IAFrB,CADG,CAMH,EAPJ,CADF,CAFF,CAPF,cA2BE,+CACE,oBAAC,MAAD,EAAQ,OAAO,CAAE,yBAAMH,CAAAA,KAAK,CAACsB,OAAN,CAAcC,IAAd,CAAmB,oBAAnB,CAAN,EAAjB,CAAiE,SAAS,CAAC,MAA3E,iBADF,cAIE,oBAAC,MAAD,EAAQ,QAAQ,CAAE,CAAChB,SAAnB,CAA8B,OAAO,CAAEU,SAAvC,CAAkD,SAAS,CAAC,OAA5D,CAAoE,UAAU,CAAC,aAA/E,0BAJF,CA3BF,CADD,CAsCC,EAvCJ,cAyCE,oBAAC,OAAD,EAAS,OAAO,CAAEhB,aAAlB,EAzCF,CADF,CAHF,CAiDD","sourcesContent":["import React, { useLayoutEffect, useState } from 'react'\nimport './syle.scss'\nimport { ScreenProps } from '../../../../../interfaces/baseIntefaces'\nimport PageContent from '../../../../modules/common/PageContent'\nimport Icon from '../../../../components/Icon'\nimport Button from '../../../../components/Button'\nimport PlaidService from '../../../../../services/plaid.service'\nimport Message from '../../../../components/Message'\nimport Loader from '../../../../components/Loader'\nimport CompanyService from '../../../../../services/company.service'\nimport SubscriptionOffer from '../../../../modules/company/SubscriptionOffer'\nimport { OFFERS } from '../../../../../constants/mockData'\n\nconst plaidService = new PlaidService()\nconst companyService = new CompanyService()\n\ninterface SubscriptionProps extends ScreenProps {\n  match: {\n    params: {\n      id: string\n    }\n  }\n}\n\nexport default function Subscription(props: SubscriptionProps) {\n  const [request_error, set_request_error] = useState<any>('')\n  const [mask, set_mask] = useState<string | null>('')\n  const [loading, set_loading] = useState<boolean>(true)\n  const companyId = props.match.params.id\n\n  const getMask = async () => {\n    try {\n      const res = await plaidService.getMask(companyId)\n\n      set_loading(false)\n\n      if ((res && res.error) || res.err_msg) {\n        set_request_error(res.error || res.err_msg)\n        set_mask(null)\n      }\n    } catch (e) {\n      set_mask(null)\n      set_request_error(e.error || e.toString())\n      setTimeout(() => set_request_error(''), 3000)\n      return set_loading(false)\n    }\n  }\n\n  const subscribe = async () => {\n    try {\n      const res = await companyService.createSubscription(companyId)\n\n      set_loading(false)\n\n      if ((res && res.error) || res.err_msg) {\n        set_request_error(res.error || res.err_msg)\n        set_mask(null)\n      }\n\n      if (res && res.is_active) {\n        set_request_error({ text: 'Subscription created', type: 'info' })\n        return setTimeout(() => props.history.push('/company/dashboard'), 2000)\n      }\n    } catch (e) {\n      set_mask(null)\n      set_request_error(e.error || e.toString())\n      setTimeout(() => set_request_error(''), 3000)\n      return set_loading(false)\n    }\n  }\n\n  useLayoutEffect(() => {\n    companyId && getMask()\n  }, [])\n\n  return loading ? (\n    <Loader />\n  ) : (\n    <article className=\"Subscription-page\">\n      <PageContent title=\"Subscription\">\n        {mask !== null ? (\n          <section className=\"subscription-offer\">\n            <h2>Early adopter Discount offer:</h2>\n            <div className=\"offer-list\">\n              {OFFERS.map((offer, i) => (\n                <SubscriptionOffer offer={offer} key={i} />\n              ))}\n            </div>\n            <div className=\"payment-method\">\n              <h2>Payment method</h2>\n              <div>\n                <p>\n                  {mask ? (\n                    <>\n                      <Icon icon=\"check-circle\" />\n                      Account ending in {mask}\n                    </>\n                  ) : (\n                    ''\n                  )}\n                </p>\n                {/*hidden for now until we have design for it*/}\n                {/*<Button>*/}\n                {/*  <Icon icon=\"blue-plus\" />*/}\n                {/*  Other Payment Method*/}\n                {/*</Button>*/}\n              </div>\n            </div>\n            <footer>\n              <Button onClick={() => props.history.push('/company/dashboard')} className=\"skip\">\n                Skip for now\n              </Button>\n              <Button disabled={!companyId} onClick={subscribe} className=\"start\" background=\"MainWarning\">\n                START MY Subscription\n              </Button>\n            </footer>\n          </section>\n        ) : (\n          ''\n        )}\n        <Message message={request_error} />\n      </PageContent>\n    </article>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}