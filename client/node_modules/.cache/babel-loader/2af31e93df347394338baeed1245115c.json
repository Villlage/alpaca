{"ast":null,"code":"import _regeneratorRuntime from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import'./style.scss';import PageHeader from'../../../../../modules/common/PageHeader';import PageContent from'../../../../../modules/common/PageContent';import FAQ from'../../../../../modules/company/CreateIsa/FAQ';import IsaOfferReview from'../../../../../modules/client/IsaOfferReview';import OfferStatus from'../../../../../modules/client/OfferStatus';import ClientIsaSignUp from'../sign-up';import{usePlaidLink}from'react-plaid-link';import PlaidService from'../../../../../../services/plaid.service';import Message from'../../../../../components/Message';import Button from'../../../../../components/Button';var plaidService=new PlaidService();var offerStatuses=['review offer','sign up','link bank','sign contract'];export default function ClientIsaOffer(props){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),offer_step=_useState2[0],set_offer_step=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),request_error=_useState4[0],set_request_error=_useState4[1];var onSuccess=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(token,metadata){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return plaidService.createItem(token,metadata);case 3:res=_context.sent;if(res){if(res.error){set_offer_step(offer_step-1);set_request_error(res.error);setTimeout(function(){return set_request_error('');},3000);}else{props.history.push(\"/isa/\".concat(res.id||1));}}_context.next=12;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);set_offer_step(offer_step-1);set_request_error(_context.t0.error||_context.t0.toString());setTimeout(function(){return set_request_error('');},3000);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function onSuccess(_x,_x2){return _ref.apply(this,arguments);};}();var handleSignUp=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:set_offer_step(offer_step+1);_context2.next=3;return props.fetchUser();case 3:open();case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function handleSignUp(){return _ref2.apply(this,arguments);};}();var config={clientName:'Commit Muse',env:'sandbox',product:['auth','transactions'],publicKey:'a004a070f0629da694fbae916414f3',onSuccess:onSuccess};var _usePlaidLink=usePlaidLink(config),open=_usePlaidLink.open,ready=_usePlaidLink.ready,error=_usePlaidLink.error;var offer_strategy={'review offer':/*#__PURE__*/React.createElement(IsaOfferReview,{onNext:function onNext(){set_offer_step(offer_step+1);}}),'sign up':/*#__PURE__*/React.createElement(ClientIsaSignUp,{onNext:handleSignUp}),'link bank':/*#__PURE__*/React.createElement(\"section\",{className:\"link_bank\"},/*#__PURE__*/React.createElement(Button,{background:\"MainWarning\",onClick:function onClick(){return open();}},\"Link Bank\"))};return/*#__PURE__*/React.createElement(\"article\",{className:\"ClientIsaOffer-page\"},/*#__PURE__*/React.createElement(PageHeader,null),/*#__PURE__*/React.createElement(PageContent,null,/*#__PURE__*/React.createElement(\"section\",{className:\"offer-steps\"},/*#__PURE__*/React.createElement(OfferStatus,{statuses:offerStatuses,activeIndex:offer_step}),offer_strategy[offerStatuses[offer_step]]),/*#__PURE__*/React.createElement(FAQ,null)),/*#__PURE__*/React.createElement(Message,{message:request_error}));}","map":{"version":3,"sources":["/Users/gilad/code/commitmuse/client/src/app/pages/public/client/isa-offer-steps/review/index.tsx"],"names":["React","useState","PageHeader","PageContent","FAQ","IsaOfferReview","OfferStatus","ClientIsaSignUp","usePlaidLink","PlaidService","Message","Button","plaidService","offerStatuses","ClientIsaOffer","props","offer_step","set_offer_step","request_error","set_request_error","onSuccess","token","metadata","createItem","res","error","setTimeout","history","push","id","toString","handleSignUp","fetchUser","open","config","clientName","env","product","publicKey","ready","offer_strategy"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport './style.scss'\nimport { PlaidMetadata, ScreenProps } from '../../../../../../interfaces/baseIntefaces'\nimport PageHeader from '../../../../../modules/common/PageHeader'\nimport PageContent from '../../../../../modules/common/PageContent'\nimport FAQ from '../../../../../modules/company/CreateIsa/FAQ'\nimport IsaOfferReview from '../../../../../modules/client/IsaOfferReview'\nimport OfferStatus from '../../../../../modules/client/OfferStatus'\nimport ClientIsaSignUp from '../sign-up'\nimport { usePlaidLink } from 'react-plaid-link'\nimport PlaidService from '../../../../../../services/plaid.service'\nimport Message from '../../../../../components/Message'\nimport Button from '../../../../../components/Button'\n\nconst plaidService = new PlaidService()\nconst offerStatuses = ['review offer', 'sign up', 'link bank', 'sign contract']\n\ninterface ClientIsaOfferProps extends ScreenProps {}\n\nexport default function ClientIsaOffer(props: ClientIsaOfferProps) {\n  const [offer_step, set_offer_step] = useState(0)\n  const [request_error, set_request_error] = useState('')\n\n  const onSuccess = async (token: string, metadata: PlaidMetadata) => {\n    try {\n      const res = await plaidService.createItem(token, metadata)\n\n      if (res) {\n        if (res.error) {\n          set_offer_step(offer_step - 1)\n          set_request_error(res.error)\n          setTimeout(() => set_request_error(''), 3000)\n        } else {\n          props.history.push(`/isa/${res.id || 1}`)\n        }\n      }\n    } catch (e) {\n      set_offer_step(offer_step - 1)\n      set_request_error(e.error || e.toString())\n      setTimeout(() => set_request_error(''), 3000)\n    }\n  }\n\n  const handleSignUp = async () => {\n    set_offer_step(offer_step + 1)\n    await props.fetchUser()\n    open()\n  }\n\n  const config = {\n    clientName: 'Commit Muse',\n    env: 'sandbox',\n    product: ['auth', 'transactions'],\n    publicKey: 'a004a070f0629da694fbae916414f3',\n    onSuccess: onSuccess,\n  }\n\n  const { open, ready, error } = usePlaidLink(config)\n\n  const offer_strategy: any = {\n    'review offer': (\n      <IsaOfferReview\n        onNext={() => {\n          set_offer_step(offer_step + 1)\n        }}\n      />\n    ),\n    'sign up': <ClientIsaSignUp onNext={handleSignUp} />,\n    'link bank': (\n      <section className=\"link_bank\">\n        <Button background=\"MainWarning\" onClick={() => open()}>\n          Link Bank\n        </Button>\n      </section>\n    ),\n  }\n\n  return (\n    <article className=\"ClientIsaOffer-page\">\n      <PageHeader />\n      <PageContent>\n        <section className=\"offer-steps\">\n          <OfferStatus statuses={offerStatuses} activeIndex={offer_step} />\n          {offer_strategy[offerStatuses[offer_step]]}\n        </section>\n        <FAQ />\n      </PageContent>\n      <Message message={request_error} />\n    </article>\n  )\n}"]},"metadata":{},"sourceType":"module"}