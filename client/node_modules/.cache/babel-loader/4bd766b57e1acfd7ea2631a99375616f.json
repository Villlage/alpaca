{"ast":null,"code":"import _regeneratorRuntime from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/gilad/code/commitmuse/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useLayoutEffect,useState}from'react';import'./style.scss';import Icon from'../../../../../components/Icon';import Message from'../../../../../components/Message';import PageContent from'../../../../../modules/common/PageContent';import SubscriptionOffer from'../../../../../modules/company/SubscriptionOffer';import{OFFERS}from'../../../../../../constants/mockData';import Loader from'../../../../../components/Loader';import PlaidService from'../../../../../../services/plaid.service';import MenuSideBar from'../../../../../modules/company/MenuSideBar';import Tabs from'../../../../../components/Tabs';var plaidService=new PlaidService();var table_headers=[{key:'date',title:'DATE',sortable:true},{key:'invoice_number',title:'Invoice Number',sortable:true},{key:'billing_period',title:'Billing\\n'+'Period',sortable:true},{key:'amount',title:'Amount',sortable:true},{key:'status',title:'Status',sortable:true}];export default function BillingAndSubs(props){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),request_error=_useState2[0],set_request_error=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),mask=_useState4[0],set_mask=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],set_loading=_useState6[1];var _useState7=useState('subscription'),_useState8=_slicedToArray(_useState7,2),active_tab=_useState8[0],set_active_tab=_useState8[1];var companyId=props.currentUser.company;var getMask=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return plaidService.getMask(companyId);case 3:res=_context.sent;set_loading(false);if(res&&res.error||res.err_msg){set_request_error(res.error||res.err_msg);set_mask(null);}_context.next=15;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);set_mask(null);set_request_error(_context.t0.error||_context.t0.toString());set_loading(false);setTimeout(function(){return set_request_error('');},3000);return _context.abrupt(\"return\",set_loading(false));case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function getMask(){return _ref.apply(this,arguments);};}();var tab_strategy={subscription:/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"tab\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"tab-title\"},\"My Subscription\"),/*#__PURE__*/React.createElement(\"div\",{className:\"offer-list\"},OFFERS.map(function(offer,i){return/*#__PURE__*/React.createElement(SubscriptionOffer,{offer:offer,key:i});})),/*#__PURE__*/React.createElement(\"div\",{className:\"payment-method\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Payment method\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,mask?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Icon,{icon:\"check-circle\"}),\"Account ending in \",mask):'')))),/*#__PURE__*/React.createElement(\"footer\",null,/*#__PURE__*/React.createElement(\"button\",null,\"Cancel Subscription\"))),billing:'',invoices:/*#__PURE__*/React.createElement(\"section\",{className:\"tab\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"tab-title\"},\"Invoices\"))};useLayoutEffect(function(){companyId?getMask():set_loading(false);},[]);return loading?/*#__PURE__*/React.createElement(Loader,null):/*#__PURE__*/React.createElement(\"article\",{className:\"BillingAndSubs-page\"},/*#__PURE__*/React.createElement(MenuSideBar,null),/*#__PURE__*/React.createElement(PageContent,{title:\"Billing and Subscription\"},/*#__PURE__*/React.createElement(\"section\",{className:\"billing-info\"},/*#__PURE__*/React.createElement(\"header\",null,/*#__PURE__*/React.createElement(Tabs,{tabs:['subscription','billing','invoices'],onChange:function onChange(tab){return set_active_tab(tab);},activeTab:active_tab})),tab_strategy[active_tab]),/*#__PURE__*/React.createElement(Message,{message:request_error})));}","map":{"version":3,"sources":["/Users/gilad/code/commitmuse/client/src/app/pages/public/company/dashboard/billing-and-subs/index.tsx"],"names":["React","useLayoutEffect","useState","Icon","Message","PageContent","SubscriptionOffer","OFFERS","Loader","PlaidService","MenuSideBar","Tabs","plaidService","table_headers","key","title","sortable","BillingAndSubs","props","request_error","set_request_error","mask","set_mask","loading","set_loading","active_tab","set_active_tab","companyId","currentUser","company","getMask","res","error","err_msg","toString","setTimeout","tab_strategy","subscription","map","offer","i","billing","invoices","tab"],"mappings":"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","sourcesContent":["import React, { useLayoutEffect, useState } from 'react'\nimport './style.scss'\nimport { ScreenProps } from '../../../../../../interfaces/baseIntefaces'\nimport Icon from '../../../../../components/Icon'\nimport Message from '../../../../../components/Message'\nimport PageContent from '../../../../../modules/common/PageContent'\nimport SubscriptionOffer from '../../../../../modules/company/SubscriptionOffer'\nimport { INVOICES, OFFERS } from '../../../../../../constants/mockData'\nimport Loader from '../../../../../components/Loader'\nimport PlaidService from '../../../../../../services/plaid.service'\nimport MenuSideBar from '../../../../../modules/company/MenuSideBar'\nimport Tabs from '../../../../../components/Tabs'\nimport Table, { Header } from '../../../../../components/Table'\nimport Button from '../../../../../components/Button'\n\nconst plaidService = new PlaidService()\n\nconst table_headers: Header[] = [\n  {\n    key: 'date',\n    title: 'DATE',\n    sortable: true,\n  },\n  {\n    key: 'invoice_number',\n    title: 'Invoice Number',\n    sortable: true,\n  },\n  {\n    key: 'billing_period',\n    title: 'Billing\\n' + 'Period',\n    sortable: true,\n  },\n  {\n    key: 'amount',\n    title: 'Amount',\n    sortable: true,\n  },\n  {\n    key: 'status',\n    title: 'Status',\n    sortable: true,\n  },\n]\n\ninterface BillingAndSubsProps extends ScreenProps {}\n\nexport default function BillingAndSubs(props: BillingAndSubsProps) {\n  const [request_error, set_request_error] = useState<any>('')\n  const [mask, set_mask] = useState<string | null>('')\n  const [loading, set_loading] = useState<boolean>(true)\n  const [active_tab, set_active_tab] = useState<string>('subscription')\n\n  const companyId = props.currentUser.company\n\n  const getMask = async () => {\n    try {\n      const res = await plaidService.getMask(companyId)\n\n      set_loading(false)\n\n      if ((res && res.error) || res.err_msg) {\n        set_request_error(res.error || res.err_msg)\n        set_mask(null)\n      }\n    } catch (e) {\n      set_mask(null)\n      set_request_error(e.error || e.toString())\n      set_loading(false)\n      setTimeout(() => set_request_error(''), 3000)\n      return set_loading(false)\n    }\n  }\n\n  const tab_strategy: any = {\n    subscription: (\n      <>\n        <div className=\"tab\">\n          <h2 className=\"tab-title\">My Subscription</h2>\n          <div className=\"offer-list\">\n            {OFFERS.map((offer, i) => (\n              <SubscriptionOffer offer={offer} key={i} />\n            ))}\n          </div>\n          <div className=\"payment-method\">\n            <h2>Payment method</h2>\n            <div>\n              <p>\n                {mask ? (\n                  <>\n                    <Icon icon=\"check-circle\" />\n                    Account ending in {mask}\n                  </>\n                ) : (\n                  ''\n                )}\n              </p>\n            </div>\n          </div>\n        </div>\n        <footer>\n          <button>Cancel Subscription</button>\n        </footer>\n      </>\n    ),\n    billing: '',\n    invoices: (\n      <section className=\"tab\">\n        <h2 className=\"tab-title\">Invoices</h2>\n        {/*<Table rows={INVOICES} headers={table_headers} />*/}\n      </section>\n    ),\n  }\n\n  useLayoutEffect(() => {\n    companyId ? getMask() : set_loading(false)\n  }, [])\n\n  return loading ? (\n    <Loader />\n  ) : (\n    <article className=\"BillingAndSubs-page\">\n      <MenuSideBar />\n      <PageContent title=\"Billing and Subscription\">\n        <section className=\"billing-info\">\n          <header>\n            <Tabs\n              tabs={['subscription', 'billing', 'invoices']}\n              onChange={tab => set_active_tab(tab)}\n              activeTab={active_tab}\n            />\n          </header>\n          {tab_strategy[active_tab]}\n        </section>\n\n        <Message message={request_error} />\n      </PageContent>\n    </article>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}